
  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.0.0.29:8501
  External URL: http://71.202.102.54:8501

  For better performance, install the Watchdog module:

  $ xcode-select --install
  $ pip install watchdog
            
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1306 [0m                                                                              [31m [0m
[31m [0m   [2m1307 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:311 in    [31m [0m
[31m [0m show_dashboard                                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 308 [0m[2m│   │   [0m[94mif[0m [96mlen[0m(st.session_state.chat_history) > [94m0[0m:                            [31m [0m
[31m [0m   [2m 309 [0m[2m│   │   │   [0mst.write([33m"[0m[33mRecent queries:[0m[33m"[0m)                                       [31m [0m
[31m [0m   [2m 310 [0m[2m│   │   │   [0m[94mfor[0m i, msg [95min[0m [96menumerate[0m(st.session_state.chat_history[-[94m3[0m:]):      [31m [0m
[31m [0m [31m❱ [0m 311 [2m│   │   │   │   [0m[94mif[0m [1;4mmsg[[0m[1;4;33m'[0m[1;4;33mrole[0m[1;4;33m'[0m[1;4m][0m == [33m'[0m[33muser[0m[33m'[0m:                                     [31m [0m
[31m [0m   [2m 312 [0m[2m│   │   │   │   │   [0mst.write([33mf[0m[33m"[0m[33m• [0m[33m{[0mmsg[[33m'[0m[33mcontent[0m[33m'[0m][:[94m50[0m][33m}[0m[33m...[0m[33m"[0m)                   [31m [0m
[31m [0m   [2m 313 [0m[2m│   │   [0m[94melse[0m:                                                                 [31m [0m
[31m [0m   [2m 314 [0m[2m│   │   │   [0mst.write([33m"[0m[33mNo recent activity[0m[33m"[0m)                                    [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'role'[0m
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:311 in    [31m [0m
[31m [0m show_dashboard                                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 308 [0m[2m│   │   [0m[94mif[0m [96mlen[0m(st.session_state.chat_history) > [94m0[0m:                            [31m [0m
[31m [0m   [2m 309 [0m[2m│   │   │   [0mst.write([33m"[0m[33mRecent queries:[0m[33m"[0m)                                       [31m [0m
[31m [0m   [2m 310 [0m[2m│   │   │   [0m[94mfor[0m i, msg [95min[0m [96menumerate[0m(st.session_state.chat_history[-[94m3[0m:]):      [31m [0m
[31m [0m [31m❱ [0m 311 [2m│   │   │   │   [0m[94mif[0m [1;4mmsg[[0m[1;4;33m'[0m[1;4;33mrole[0m[1;4;33m'[0m[1;4m][0m == [33m'[0m[33muser[0m[33m'[0m:                                     [31m [0m
[31m [0m   [2m 312 [0m[2m│   │   │   │   │   [0mst.write([33mf[0m[33m"[0m[33m• [0m[33m{[0mmsg[[33m'[0m[33mcontent[0m[33m'[0m][:[94m50[0m][33m}[0m[33m...[0m[33m"[0m)                   [31m [0m
[31m [0m   [2m 313 [0m[2m│   │   [0m[94melse[0m:                                                                 [31m [0m
[31m [0m   [2m 314 [0m[2m│   │   │   [0mst.write([33m"[0m[33mNo recent activity[0m[33m"[0m)                                    [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'role'[0m
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:311 in    [31m [0m
[31m [0m show_dashboard                                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 308 [0m[2m│   │   [0m[94mif[0m [96mlen[0m(st.session_state.chat_history) > [94m0[0m:                            [31m [0m
[31m [0m   [2m 309 [0m[2m│   │   │   [0mst.write([33m"[0m[33mRecent queries:[0m[33m"[0m)                                       [31m [0m
[31m [0m   [2m 310 [0m[2m│   │   │   [0m[94mfor[0m i, msg [95min[0m [96menumerate[0m(st.session_state.chat_history[-[94m3[0m:]):      [31m [0m
[31m [0m [31m❱ [0m 311 [2m│   │   │   │   [0m[94mif[0m [1;4mmsg[[0m[1;4;33m'[0m[1;4;33mrole[0m[1;4;33m'[0m[1;4m][0m == [33m'[0m[33muser[0m[33m'[0m:                                     [31m [0m
[31m [0m   [2m 312 [0m[2m│   │   │   │   │   [0mst.write([33mf[0m[33m"[0m[33m• [0m[33m{[0mmsg[[33m'[0m[33mcontent[0m[33m'[0m][:[94m50[0m][33m}[0m[33m...[0m[33m"[0m)                   [31m [0m
[31m [0m   [2m 313 [0m[2m│   │   [0m[94melse[0m:                                                                 [31m [0m
[31m [0m   [2m 314 [0m[2m│   │   │   [0mst.write([33m"[0m[33mNo recent activity[0m[33m"[0m)                                    [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'role'[0m
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:563 in    [31m [0m
[31m [0m show_document_management                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 560 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 561 [0m[2m│   [0m[94mif[0m [96mlen[0m(st.session_state.chat_history) > [94m0[0m:                                [31m [0m
[31m [0m   [2m 562 [0m[2m│   │   [0mst.markdown([33m"[0m[33m**Recent Queries:**[0m[33m"[0m)                                    [31m [0m
[31m [0m [31m❱ [0m 563 [2m│   │   [0mrecent_queries = [1;4m[msg [0m[1;4;94mfor[0m[1;4m msg [0m[1;4;95min[0m[1;4m st.session_state.chat_history [0m[1;4;94mif[0m[1;4m msg[0m [31m [0m
[31m [0m   [2m 564 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m 565 [0m[2m│   │   [0m[94mfor[0m query [95min[0m recent_queries:                                          [31m [0m
[31m [0m   [2m 566 [0m[2m│   │   │   [0mst.markdown([33mf[0m[33m"[0m[33m• [0m[33m{[0mquery[[33m'[0m[33mcontent[0m[33m'[0m][:[94m80[0m][33m}[0m[33m...[0m[33m"[0m)                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:563 in    [31m [0m
[31m [0m <listcomp>                                                                           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 560 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 561 [0m[2m│   [0m[94mif[0m [96mlen[0m(st.session_state.chat_history) > [94m0[0m:                                [31m [0m
[31m [0m   [2m 562 [0m[2m│   │   [0mst.markdown([33m"[0m[33m**Recent Queries:**[0m[33m"[0m)                                    [31m [0m
[31m [0m [31m❱ [0m 563 [2m│   │   [0mrecent_queries = [msg [94mfor[0m msg [95min[0m st.session_state.chat_history [94mif[0m [1;4mmsg[0m [31m [0m
[31m [0m   [2m 564 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m 565 [0m[2m│   │   [0m[94mfor[0m query [95min[0m recent_queries:                                          [31m [0m
[31m [0m   [2m 566 [0m[2m│   │   │   [0mst.markdown([33mf[0m[33m"[0m[33m• [0m[33m{[0mquery[[33m'[0m[33mcontent[0m[33m'[0m][:[94m80[0m][33m}[0m[33m...[0m[33m"[0m)                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mKeyError: [0m[32m'role'[0m
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mexec_code.py[0m: [31m [0m
[31m [0m 121 in exec_func_with_error_handling                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/[0m[1mscript_runner[0m [31m [0m
[31m [0m [1m.py[0m:645 in code_to_exec                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1311 in   [31m [0m
[31m [0m <module>                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1308 [0m[2m│   [0mpages[selected_page]()                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m [31m❱ [0m1311 [2m│   [0m[1;4mmain()[0m                                                                    [31m [0m
[31m [0m   [2m1312 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1308 in   [31m [0m
[31m [0m main                                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   [0mst.rerun()                                                            [31m [0m
[31m [0m   [2m1306 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1307 [0m[2m│   [0m[2m# Show selected page[0m                                                      [31m [0m
[31m [0m [31m❱ [0m1308 [2m│   [0m[1;4mpages[selected_page]()[0m                                                    [31m [0m
[31m [0m   [2m1309 [0m                                                                              [31m [0m
[31m [0m   [2m1310 [0m[94mif[0m [91m__name__[0m == [33m"[0m[33m__main__[0m[33m"[0m:                                                    [31m [0m
[31m [0m   [2m1311 [0m[2m│   [0mmain()                                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1177 in   [31m [0m
[31m [0m show_enhanced_chat                                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1174 [0m[2m│   │   [0m[94mfor[0m i, entry [95min[0m [96menumerate[0m([96mreversed[0m(st.session_state.chat_history[-[94m5[0m:] [31m [0m
[31m [0m   [2m1175 [0m[2m│   │   │   [0m[94mwith[0m st.expander([33mf[0m[33m"[0m[33mQuery [0m[33m{[0m[96mlen[0m(st.session_state.chat_history)[90m [0m-[90m [0mi[33m}[0m [31m [0m
[31m [0m   [2m1176 [0m[2m│   │   │   │   [0mst.caption([33mf[0m[33m"[0m[33mAsked at: [0m[33m{[0mentry[[33m'[0m[33mtimestamp[0m[33m'[0m].strftime([33m'[0m[33m%[0m[33mY-[0m[33m%[0m[33mm-[0m[33m%d[0m [31m [0m
[31m [0m [31m❱ [0m1177 [2m│   │   │   │   [0m[1;4mdisplay_enhanced_query_result(entry[[0m[1;4;33m'[0m[1;4;33mresult[0m[1;4;33m'[0m[1;4m], include_sugges[0m [31m [0m
[31m [0m   [2m1178 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1179 [0m[2m│   │   [0m[94mif[0m st.button([33m"[0m[33m🗑️ Clear Chat History[0m[33m"[0m, key=[33m"[0m[33mclear_enhanced_chat[0m[33m"[0m):      [31m [0m
[31m [0m   [2m1180 [0m[2m│   │   │   [0mst.session_state.chat_history = []                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/Users/alfredodiaz/udemy practice/local-legal-ai/frontend/[0m[1mstreamlit_app.py[0m:1232 in   [31m [0m
[31m [0m display_enhanced_query_result                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1229 [0m[2m│   │   [0mst.markdown([33m"[0m[33m### 📚 Source Documents[0m[33m"[0m)                                [31m [0m
[31m [0m   [2m1230 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1231 [0m[2m│   │   [0m[94mfor[0m i, source [95min[0m [96menumerate[0m(result[[33m"[0m[33msources[0m[33m"[0m]):                        [31m [0m
[31m [0m [31m❱ [0m1232 [2m│   │   │   [0m[94mwith[0m [1;4mst.expander([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33m📄 Source [0m[1;4;33m{[0m[1;4mi+[0m[1;4;94m1[0m[1;4;33m}[0m[1;4;33m - [0m[1;4;33m{[0m[1;4msource[[0m[1;4;33m'[0m[1;4;33msource[0m[1;4;33m'[0m[1;4m][0m[1;4;33m}[0m[1;4;33m (Similari[0m [31m [0m
[31m [0m   [2m1233 [0m[2m│   │   │   │   [0m                                                              [31m [0m
[31m [0m   [2m1234 [0m[2m│   │   │   │   [0m[2m# Enhanced source metadata[0m                                    [31m [0m
[31m [0m   [2m1235 [0m[2m│   │   │   │   [0mcol1, col2 = st.columns([94m2[0m)                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/runtime/[0m[1mmetrics_util.py[0m:444 in     [31m [0m
[31m [0m wrapped_func                                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/elements/[0m[1mlayouts.py[0m:601 in         [31m [0m
[31m [0m expander                                                                             [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:522 in _block   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2m/usr/local/lib/python3.11/site-packages/streamlit/[0m[1mdelta_generator.py[0m:602 in          [31m [0m
[31m [0m _check_nested_element_violation                                                      [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mStreamlitAPIException: [0mExpanders may not be nested inside other expanders.
  Stopping...
